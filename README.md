# SMM Planer

SMM Planer - это скрипт на Python, который автоматически публикует сообщения в разных социальных сетях (Telegram, ВКонтакте и Одноклассники) согласно расписанию, указанному в Google Sheets. Сообщения берутся из Google Документов.


## Установка

1. Склонируйте репозиторий:

``` bash
git clone https://github.com/ludwig300/smm_planer.git
```

2. Установите зависимости:

```
$ pip install -r requirements.txt
```

3. Создайте файл `.env` в корне проекта и добавьте необходимые переменные окружения:

```
GOOGLE_API_CREDENTIALS=path/to/your/credentials.json
SPREADSHEET_ID=your_spreadsheet_id
VK_ACCESS_TOKEN=your_vk_access_token
TELEGRAM_API_TOKEN=your_telegram_api_token
OK_ACCESS_TOKEN=your_ok_access_token
OK_PUBLIC_KEY=your_ok_public_key
OK_PRIVATE_KEY=your_ok_private_key
```


Для того чтобы начать работать с Google API для работы с Google Таблицами и Google Документами, вам нужно выполнить следующие шаги:

1. Создайте проект в Google Cloud Platform (GCP):
   * Перейдите на сайт [Google Cloud Platform](https://console.cloud.google.com/) и войдите в свой аккаунт Google.
   * Если у вас еще нет проекта, создайте новый, нажав на "Создать проект" или выбрав существующий из списка.
2. Включите Google Sheets API и Google Docs API для вашего проекта:
   * В поисковой строке на главной странице консоли GCP введите "Google Sheets API" и перейдите на страницу API.
   * Нажмите "Включить" для активации Google Sheets API.
   * Вернитесь на главную страницу консоли GCP и аналогичным образом найдите и включите "Google Docs API".
3. Создайте учетные данные для доступа к API:
   * В левом боковом меню выберите "Учетные данные".
   * Нажмите на кнопку "Создать учетные данные" и выберите "ID клиента OAuth".
   * Если у вас еще нет экрана согласия, нажмите на "Создать экран согласия" и заполните необходимые поля.
   * Выберите "Приложение для настольных ПК" в качестве типа приложения и нажмите "Создать".
   * Загрузите файл JSON с учетными данными, нажав на кнопку "Скачать" рядом с созданным ID клиента OAuth.

## Использование

1. Заполните Google Sheets таблицу, следуя примеру:

| Дата   | Время | Соцсети                   | Ссылка на Google Документ                              | URL фото                                                | Telegram Chat ID | ВКонтакте Owner ID | OK Group ID |
| ---------- | ---------- | -------------------------------- | ---------------------------------------------------------------------- | ----------------------------------------------------------- | ---------------- | --------------------------- | ----------- |
| 22.03.2023 | 15:00      | Telegram, ВКонтакте, ok | [https://docs.google.com/document/](https://docs.google.com/document/)... | [https://example.com/photo.jpg](https://example.com/photo.jpg) | 123456789        | -123456789                  | 123456789   |

2. Запустите скрипт:

```
$ python main.py
```

Скрипт будет автоматически отправлять сообщения согласно расписанию, указанному в Google Sheets.

## Использование table2

#### Как заполнять таблицу для table2
Создать листы requests log, log, Соцсети
 
Лист requests log

 | Дата | Время | Ссылка на Google Документ | URL фото | Соцсеть(TG, VK, OK) | в колонках  F:L будет отображаться статус | в колонках M:S будет отображаться ссылка на пост |
 |---|-------|---------------------------|----------|---------------------|-------------------------------------------|--------------------------------------------------|
 | DD.MM.GG | HH:MM | [https://docs.google.com/document/](https://docs.google.com/document/)... | [https://example.com/photo.jpg](https://example.com/photo.jpg) |
 |||||| 
 |Вводить начиная с A3|   |||| 

-----
Лист Соцсети

 | Уникальное имя                  | Тип(TG, OK, VK)              | id(чата ТГ, Группы ОК, Пользователя или группы в VK) | 
 |---------------------------------|------------------------------|------------------------------------------------------| 
 | Пустая строка                   |                              |                                                    | 
 | Вводить начиная с A3   |                              |                                                    | 
 | Учитываются значения с A3 по A7 |                              |                                                    | 
----

Лист log не нужно заполнять.
В листе log первые две строки будут пустыми

-----
#### Notes
1. Если удаляете данные в requests log также удалите содержимое соответствующих строк в log  
2. Лист читается снизу вверх:
   * если в листе записаны прошедшие даты то очередь публикации будет идти с низу вверх
   * Перед каждой публикации в TG(telegramm) таймаут 6 секунд
   * Если TG не указан публикуется без таймаута
   * если в листе много значений с прошедшим временем лист не обновится пока все такие значения не будут обработанны
3. Если удалить содержимое log и не удалить соответствующие строки в log request посты будут отправлены снова
4. Рекомендуется заполнять колонку содержащую тип в последнюю очередь (в листах request log и Соцсети)
5. Колонка время **HH:MM** никаких секунд
6. Если указывать несколько типов в requests log (TG, OK, VK) они должны быть разделены запятой и одним пробельным символом.
После последнего типа не должно быть никаких символов.
7. Можно не указывать текст или картинку, но только одно
8. Только одна ссылка в ячейке
9. Рекомендуется использовать только будущие дата\время
10. Скрипт обращается к листам по именам. Имена для копирования (копировать без кавычек)
    * 'log'
    * 'requests log'
    * 'Соцсети' 
11. Периодически чистите log и requests log чтобы они не были слишком большими.
----
#### Запустите скрипт:

```
$ python table2.py
```

## Поддерживаемые социальные сети

* Telegram
* ВКонтакте
* Одноклассники
